<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rosy Python Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.11.3/brython.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.11.3/brython_stdlib.min.js"></script>
    <style>
      body { 
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; 
      }
      .break-all {
        word-break: break-all;
      }
      .display {
        min-height: 64px;
      }
    </style>
</head>
<body onload="brython()">

    <main class="relative min-h-screen w-full flex items-center justify-center bg-gradient-to-br from-rose-100 to-pink-200 p-4 overflow-hidden">
      <!-- Decorative Flowers -->
      <svg viewBox="0 0 100 100" class="absolute opacity-20 text-pink-300 w-64 h-64 -top-20 -left-20" xmlns="http://www.w3.org/2000/svg"><path d="M50 30 C 40 10, 60 10, 50 30 M50 30 C 30 40, 30 60, 50 70 M50 30 C 70 40, 70 60, 50 70 M50 30 C 40 10, 60 10, 50 30 M50 70 C 40 90, 60 90, 50 70" fill="currentColor" stroke="white" stroke-width="2" transform="rotate(45 50 50)"></path><circle cx="50" cy="50" r="10" fill="white"></circle></svg>
      <svg viewBox="0 0 100 100" class="absolute opacity-20 text-pink-300 w-48 h-48 -bottom-10 -right-10" xmlns="http://www.w3.org/2000/svg"><path d="M50 30 C 40 10, 60 10, 50 30 M50 30 C 30 40, 30 60, 50 70 M50 30 C 70 40, 70 60, 50 70 M50 30 C 40 10, 60 10, 50 30 M50 70 C 40 90, 60 90, 50 70" fill="currentColor" stroke="white" stroke-width="2" transform="rotate(45 50 50)"></path><circle cx="50" cy="50" r="10" fill="white"></circle></svg>
      <svg viewBox="0 0 100 100" class="absolute opacity-20 text-pink-300 w-32 h-32 top-1/4 right-10" xmlns="http://www.w3.org/2000/svg"><path d="M50 30 C 40 10, 60 10, 50 30 M50 30 C 30 40, 30 60, 50 70 M50 30 C 70 40, 70 60, 50 70 M50 30 C 40 10, 60 10, 50 30 M50 70 C 40 90, 60 90, 50 70" fill="currentColor" stroke="white" stroke-width="2" transform="rotate(45 50 50)"></path><circle cx="50" cy="50" r="10" fill="white"></circle></svg>
      <svg viewBox="0 0 100 100" class="absolute opacity-20 text-pink-300 w-24 h-24 bottom-1/3 left-5" xmlns="http://www.w3.org/2000/svg"><path d="M50 30 C 40 10, 60 10, 50 30 M50 30 C 30 40, 30 60, 50 70 M50 30 C 70 40, 70 60, 50 70 M50 30 C 40 10, 60 10, 50 30 M50 70 C 40 90, 60 90, 50 70" fill="currentColor" stroke="white" stroke-width="2" transform="rotate(45 50 50)"></path><circle cx="50" cy="50" r="10" fill="white"></circle></svg>

      <!-- Calculator Body -->
      <div class="w-full max-w-sm bg-white/40 backdrop-blur-lg rounded-3xl shadow-2xl shadow-pink-300/50 p-6 border border-white/30">
        
        <!-- Display -->
        <div id="display" class="display bg-pink-100/50 rounded-xl p-4 text-right w-full mb-4 shadow-inner overflow-hidden text-4xl md:text-5xl text-pink-900 font-light break-all">0</div>
        
        <!-- Buttons -->
        <div class="grid grid-cols-4 grid-rows-5 gap-4">
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-200/80 text-pink-800 hover:bg-pink-200">C</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-200/80 text-pink-800 hover:bg-pink-200">DEL</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-300/80 text-pink-900 hover:bg-pink-300">÷</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-300/80 text-pink-900 hover:bg-pink-300">×</button>
            
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">7</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">8</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">9</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-300/80 text-pink-900 hover:bg-pink-300">-</button>
            
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">4</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">5</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">6</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-300/80 text-pink-900 hover:bg-pink-300">+</button>
            
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">1</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">2</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">3</button>
            <button class="calc-btn row-span-2 rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-pink-500 text-white hover:bg-pink-600">=</button>
            
            <button class="calc-btn col-span-2 rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">0</button>
            <button class="calc-btn rounded-2xl text-2xl font-medium shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-pink-400 active:shadow-inner active:translate-y-px bg-white/70 text-pink-700 hover:bg-white">.</button>
        </div>
      </div>
    </main>

    <script type="text/python">
    from browser import document

    display = document["display"]
    buttons = document.select(".calc-btn")

    is_result_state = False

    def get_button_type(label):
        if label in "÷×-+": return "operator"
        if label in ("C", "DEL"): return "action"
        if label == "=": return "equals"
        return "number"

    def handle_click(event):
        global is_result_state
        value = event.target.text
        current_display = display.text

        if value == "C":
            display.text = "0"
            is_result_state = False
        elif value == "DEL":
            if is_result_state:
                display.text = "0"
                is_result_state = False
            else:
                new_display = current_display[:-1]
                display.text = new_display if new_display else "0"
        elif value == "=":
            if is_result_state:
                return
            try:
                expression = current_display.replace("×", "*").replace("÷", "/")
                allowed_chars = "0123456789.+-*/"
                if not all(char in allowed_chars for char in expression):
                    raise ValueError("Invalid expression")

                result = eval(expression)
                
                # Format to a reasonable number of decimal places
                if isinstance(result, float):
                    result = round(result, 10)
                if isinstance(result, float) and result.is_integer():
                    result = int(result)

                display.text = str(result)
            except (SyntaxError, ZeroDivisionError, ValueError, TypeError):
                display.text = "Error"
            is_result_state = True
        elif get_button_type(value) == "operator":
            if current_display == "Error":
              return
            is_result_state = False
            if current_display and current_display[-1] in "+-×÷":
                display.text = current_display[:-1] + value
            else:
                display.text += value
        elif value == ".":
            if current_display == "Error":
                return
            is_result_state = False
            last_number = ""
            for char in reversed(current_display):
                if char in "+-×÷":
                    break
                last_number = char + last_number
            if "." not in last_number:
                display.text += "."
        else: # is a number
            if is_result_state or current_display == "0" or current_display == "Error":
                display.text = value
                is_result_state = False
            else:
                display.text += value

    for button in buttons:
        button.bind("click", handle_click)
    </script>
</body>
</html>